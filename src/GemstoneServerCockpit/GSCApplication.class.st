Class {
	#name : #GSCApplication,
	#superclass : #GSCTool,
	#instVars : [
		'config',
		'appIndex'
	],
	#category : #'GemstoneServerCockpit-Model'
}

{ #category : #accessing }
GSCApplication >> appIndex [
	^ appIndex ifNil: [ GSCConfigError signal: 'appIndex not defined for application' ]
]

{ #category : #accessing }
GSCApplication >> application [
	^ self
]

{ #category : #'as yet unclassified' }
GSCApplication >> autogeneratedIndex [
	^ self root autogeneratedAppIndexFor: self
]

{ #category : #building }
GSCApplication >> build [

	"Ensure auto generated index exists"
"	self autogeneratedIndex."

	self add: GSCConfigurationEditor then: [ :editor |
		editor
			title: 'App config';
			config: config.
	].

	self add: GSCFolder then: [ :folder |
		folder name: 'git repositories'.
		
		(self configAt: 'gitRepositories') dataDo: [ :key :conf |
			folder add: GSCGitRepository then: [ :git |
				git
					folderPath: (conf at: 'path');
					branch: (conf at: 'branch');
					url: (conf at: 'url')
			]
		]
	]

]

{ #category : #accessing }
GSCApplication >> config [

	^ config
]

{ #category : #accessing }
GSCApplication >> config: anObject [

	config := anObject.
	
	"Try to read the number of the conf file."
	appIndex := config indexFromFilename
]

{ #category : #'as yet unclassified' }
GSCApplication >> doReConfig [
"	(self uiConfirm: 'Really fully rebuild this application from its config file?') ifTrue: [ "
		self recreateMyself
"	]"
]

{ #category : #testing }
GSCApplication >> isBeta [
	^ true "TODO"
	
]

{ #category : #'as yet unclassified' }
GSCApplication >> longName [
	^ self configAt: 'project:name'
]

{ #category : #'as yet unclassified' }
GSCApplication >> recreateMyself [
	"TODO: Warn if config unsaved?"
	
	"Remove/delete myself"
	self parent removeTool: self.
	
	"Add a new application like myself, with my config"
	config createScheme buildApplicationToolInto: self core rootTool
]

{ #category : #rendering }
GSCApplication >> renderBodyOn: html [
	html div: 'TBD'
]

{ #category : #'as yet unclassified' }
GSCApplication >> shortCode [
	^ self configAt: 'project:shortCode'
]

{ #category : #accessing }
GSCApplication >> title [
	^ self longName
]
